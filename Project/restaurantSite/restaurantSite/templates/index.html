<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="UTF-8">
    <title>Sharktooth</title>
<!--    <link rel="icon" href="~/Images/amongus.png" type="image/x-icon">-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<style>
    body{
        background-color: forestgreen;
        /*padding-top: 40px;*/
        /*!*display: flex;*!*/
        /*justify-content: center;*/
        /*align-items: center;*/
        /*height: 100vh;*/
        /*margin: 0;*/
        /*overflow: hidden;*/
        margin: 0;
    }
    .top-right-button {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 1000;
    }

    .navbar{
        width: 100%; /* Occupy full width */
        background-color: #000000;
        position: fixed;
        top: 0;
        left: 0;
        display: flex;
        /*justify-content: space-around; !* Distribute items evenly *!*/
        /*align-items: center;*/
        /*border-bottom: 2px solid #000000;*/
        padding: 12px;
        z-index: 999;
    }

    .navbar ul{
        list-style-type: none;
        justify-content: space-evenly;
        color: #000000;
        font-weight: bold;
        margin: 0;
        padding-right: 200px;
        overflow: hidden;
        width: 100%;
        display: flex;
    }

    .navbar a{
        color: white;
        text-decoration: none;
        padding: 5px;
        display: block;
        text-align: center;
    }

    .navbar a:hover{
        background-color: hsl(0, 0%, 15%);
    }

    .navbar li{
        float: right;
    }

    h1{
        text-align: center;
        color: white;
    }

    header{
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 20px 0;
    }
    
    header .icon-cart{
        position: fixed;
        top: -15px;
        right: 200px;
        z-index: 1005;
        color: white;
    }

    header .icon-cart:hover{
        cursor: pointer;
    }

    header .icon-cart span{
        display: flex;
        width: 30px;
        height: 30px;
        background-color: red;
        justify-content: center;
        align-items: center;
        color: white;
        border-radius: 50%;
        position: absolute;
        top: 50%;
        right: -20px;
        z-index: 1005;
    }

    /*.container{*/
    /*    width: 900px;*/
    /*    max-width: 90vw;*/
    /*    height: 550px;*/
    /*    background-position: center;*/
    /*    !*border: 5px solid black;*!*/
    /*    !*!*border-radius: 10px;*!*/
    /*    !*overflow: hidden;*!*/
    /*    margin: 0 0;*/
    /*    padding-top: 20px;*/

    /*    position: relative;*/
    /*    align-items: stretch;*/
    /*}*/

    /*.container img {*/
    /*    width: 100%;*/
    /*    height: 100%;*/
    /*    object-fit: cover;*/

    /*    transition: opacity 0.3s ease;*/
    /*    display: block;*/
    /*}*/

    /*.container img:hover {*/
    /*    box-shadow: 0 0 20px rgba(0,0,0,0.5);*/
    /*    opacity: 0.7;*/
    /*}*/

    .container{
        width: 900px;
        max-width: 90vw;
        margin: auto;
        text-align: center;
        padding-top: 10px;
    }

    .listProduct .item img{
        width: 90%;
        filter: drop-shadow(0 50px 20px #0009);
    }

    .listProduct{
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
    }

    .listProduct .item{
        background-color: #eeeee6;
        padding: 20px;
        border-radius: 20px;
    }

    .listProduct .item h2{
        font-weight: 500;
        font-size: large;
    }

    .listProduct .item .price{
        letter-spacing: 7px;
        font-size: small;
    }

    .listProduct .item button{
        background-color: #335432;
        color: #eee;
        padding: 5px 10px;
        border-radius: 20px;
        margin-top: 10px;
        border: none;
        cursor: pointer;
    }

    svg{
        width: 30px;
    }

    .cartTab{
        width: 400px;
        padding-top: 50px;
        background-color: #353432;
        color: #eee;
        position: fixed;
        inset: 0 -400px 0 auto;
        display: grid;
        grid-template-rows: 70px 1fr 70px;
        transition: transform .20s;
    }

    body.showCart .cartTab{
        inset: 0 0 0 auto;
    }

    body.showCart .container{
        transform: translate(-250px);
    }

    .cartTab h1{
        padding: 20px;
        margin: 0;
        font-weight: 300;
    }

    .cartTab .btn{
        display: grid;
        grid-template-columns: repeat(2, 1fr);
    }

    .cartTab .btn button{
        background-color: yellow;
        border: none;
        /*font-family:;*/
        font-weight: 500;
        cursor: pointer;
    }

    .cartTab .btn .close{
        background-color: #eee;
    }

    .cartTab .listCart .item img{
        width: 100%;
    }

    .cartTab .listCart .item{
        display: grid;
        grid-template-columns: 70px 150px 50px 1fr;
        gap: 10px;
        text-align: center;
        align-items: center;
    }

    .listCart .quantity span{
        display: inline-block;
        width: 25px;
        height: 25px;
        background-color: #eee;
        color: #555;
        border-radius: 50%;
        cursor: pointer;
    }

    .listCart .item:nth-child(even){
        background-color: #eee1;
    }

    .listCart{
        overflow: auto;
    }

    .listCart::-webkit-scrollbar{
        width: 0;
    }

    .menu-item {
        background-color: #ffffff;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
    }

    /*.accordion-button{*/
    /*    background-color: #007bff;*/
    /*    color: #ffffff;*/
    /*    border-radius: 8px;*/
    /*    border: none;*/
    /*}*/

    .content {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        color: #ffffff;
        text-align: center;
        transition: background-color 0.3s ease;
        z-index: 1;
    }

    .content:hover {
        background-color: rgba(0, 0, 0, 0.7);
    }

    /*.content a {*/
    /*    text-decoration: none;*/
    /*    color: #ffffff;*/
    /*    font-size: 28px;*/
    /*    font-weight: bold;*/
    /*    position:absolute;*/
    /*    top: 50%;*/
    /*    left: 50%;*/
    /*    transform: translate(-50%, -50%);*/
    /*}*/

    .accordion-button:hover{
        background-color: green;
    }

    .image-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    }

    /*.image-wrapper img {*/
    /*width: 100%;*/
    /*height: 100%;*/
    /*object-fit: cover;*/
    /*}*/

    .logo{
        position: fixed;
        top: 1%;
        left: 1%;
        z-index: 1001; /* Ensure the logo is above other elements*/
    }

    @media screen and (max-width: 992px){
        .listProduct{
            grid-template-columns: repeat(3, 1fr);
        }
    }

    @media screen and (max-width: 480px){
        .listProduct{
            grid-template-columns: repeat(2, 1fr);
        }
    }


</style>



<body class="">
    {% load static %}

<!--    <h1>Sharktooth Software</h1>-->

    <nav class="navbar">
        <ul>
            <li><a href="#appetizers">Appetizers</a></li>
            <li><a href="#food">Food</a></li>
            <li><a href="#drinks">Drinks</a></li>
        </ul>
    </nav>

    <div class="top-right-button">
        <a href="{% url 'create_restaurant' %}" class="btn btn-primary">Create Restaurant</a>
    </div>

    <div class="logo">
        <div class="content">
            <a href="index.html"><img
                    src="{% static '/images/amongus.png' %}"
                    alt="Error: Image not showing"
                    width="50"
                    height="45"></a>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="title">SharkTooth Restaurant</div>
            <div class="icon-cart">
                <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="80" fill="none" viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 4h1.5L9 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm-8.5-3h9.25L19 7H7.312"/>
                </svg>
                <span>0</span>
            </div>
        </header>

        <div class="listProduct">
            <div class="item">
                <img src="{% static '/images/amongus.png' %}" alt="Error: Image Not Showing">
                <h2>NAME PRODUCT</h2>
                <div class="price">$ITEM PRICE</div>
                <button class="addCart">
                    Add To Cart
                </button>
            </div>
        </div>
    </div>

    <div class="cartTab">
        <h1>Shopping Cart</h1>
        <div class="listCart">
            <div class="item">
                <div class="image">
                     <img src="{% static '/images/amongus.png' %}" alt="Error: Image Not Found">
                </div>
                <div class="name">
                    NAME
                </div>
                <div class="totalPrice">
                    $Item Price
                </div>
                <div class="quantity">
                    <span class="minus"><</span>
                    <span>1</span>
                    <span class="plus">></span>
                </div>
            </div>
        </div>
        <div class="btn">
            <button class="close">CLOSE</button>
            <button class="checkOut">CHECKOUT</button>
            <button id="clearCart" class="clearCart">CLEAR CART</button>
        </div>
    </div>

<!--    {% for item in array %}-->
<!--    <div class="accordion" id="accordionPanelsStayOpenExample">-->
<!--        <div class="accordion-item">-->
<!--            <h2 class="accordion-header" id="panelsStayOpen-heading{{ item }}">-->
<!--                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapse{{ item }}" aria-expanded="false" aria-controls="panelsStayOpen-collapse{{ item }}">-->
<!--                    Accordion Item {{ item }}-->
<!--                </button>-->
<!--            </h2>-->
<!--            <div id="panelsStayOpen-collapse{{ item }}" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-heading{{ item }}">-->
<!--                <div class="accordion-body">-->
<!--                    <strong>This is the first item's accordion body.</strong> It is shown by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--    {% endfor %}-->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<!--    Javascript for Cart Functionality-->
    <script>
        let iconCart = document.querySelector('.icon-cart');
        let closeCart = document.querySelector('.close');
        let body = document.querySelector('body');
        let listProduct = document.querySelector('.listProduct');
        let listCartHTML = document.querySelector('.listCart');
        let iconCartSpan = document.querySelector('.icon-cart span');
        let clearCart = document.querySelector('.clearCart');

        let listProducts = [];
        let carts = [];

        iconCart.addEventListener('click', () => {
            body.classList.toggle('showCart')
        })
        closeCart.addEventListener('click', () => {
            body.classList.toggle('showCart')
        })
        clearCart.addEventListener('click', () => {
            clearItemsInCart();
        })

        const addDataToHTML = () => {
            listProduct.innerHTML = '';
            if(listProducts.length > 0){
                listProducts.forEach(product => {
                    let newProduct = document.createElement('div');
                    newProduct.classList.add('item');
                    newProduct.dataset.id = product.id;
                    newProduct.innerHTML = `<img src="${product.image}" alt="Error: Image Not Showing">
                                            <h2>${product.name}</h2>
                                            <div class="price">$${product.price}</div>
                                            <button class="addCart">
                                                Add To Cart
                                            </button>`;
                    listProduct.appendChild(newProduct);
                })
            }
        }

        // Add To Cart Function
        listProduct.addEventListener('click', (event) =>{
            let positionClick = event.target;
            if(positionClick.classList.contains('addCart')){
                let product_id = positionClick.parentElement.dataset.id;
                addToCart(product_id);
            }
        })

        const addToCart = (product_id) => {
            let positionThisProductInCart = carts.findIndex((value) => value.product_id == product_id);
            if(carts.length <= 0){
                carts = [{
                    product_id: product_id,
                    quantity: 1
                }]
            }else if(positionThisProductInCart < 0){
                carts.push({
                    product_id: product_id,
                    quantity: 1
                });
            }else{
                carts[positionThisProductInCart].quantity += 1;
            }
            addCartToHTML();
            addCartToMemory();
        }

        const addCartToMemory = () => {
            localStorage.setItem('cart', JSON.stringify(carts));
        }

        const addCartToHTML = () => {
            listCartHTML.innerHTML = '';
            let totalQuantity = 0;
            if(carts.length > 0){
                carts.forEach(cart => {
                    totalQuantity = totalQuantity + cart.quantity;
                    let newCart = document.createElement('div');
                    newCart.classList.add('item');
                    newCart.dataset.id = cart.product_id;
                    let positionProduct = listProducts.findIndex((value) => value.id == cart.product_id);
                    let info = listProducts[positionProduct];
                    newCart.innerHTML =
                        `<div class="image">
                            <img src="${info.image}" alt="Error: Image Not Found">
                        </div>
                        <div class="name">
                            ${info.name}
                        </div>
                        <div class="totalPrice">$
                            ${info.price * cart.quantity}
                        </div>
                        <div class="quantity">
                            <span class="minus"><</span>
                            <span>${cart.quantity}</span>
                            <span class="plus">></span>
                        </div>`;
                    listCartHTML.appendChild(newCart);
                })
            }
            iconCartSpan.textContent = totalQuantity;
        }

        listCartHTML.addEventListener('click', (event) => {
            let positionClick = event.target;
            if(positionClick.classList.contains('minus') || positionClick.classList.contains('plus')){
                let product_id = positionClick.parentElement.parentElement.dataset.id;
                let type = 'minus';
                if(positionClick.classList.contains('plus')){
                    type = 'plus';
                }
                changeQuantity(product_id, type);
            }
        })

        const changeQuantity = (product_id, type) => {
            let positionItemInCart = carts.findIndex((value) => value.product_id == product_id)
            if(positionItemInCart >= 0){
                switch(type){
                    case 'plus':
                        carts[positionItemInCart].quantity += 1;
                        break;

                    default:
                        let valueChange = carts[positionItemInCart].quantity - 1;
                        if(valueChange > 0){
                            carts[positionItemInCart].quantity = valueChange;
                        } else{
                            carts.splice(positionItemInCart, 1);
                        }
                        break;
                }
            }
            addCartToMemory();
            addCartToHTML();
        }

        const clearItemsInCart = () => {
            carts = [];
            addCartToHTML();
            addCartToMemory()
        }

        const initApp = () => {
            //get data from json
            listProducts = [
                {
                    "id": 1,
                    "name": "Classic Mojito",
                    "price": 10,
                    "image": "{% static '/images/amongus.png' %}"
                },
                {
                    "id": "2",
                    "name": "Strawberry Daiquiri",
                    "price": 12,
                    "image": "{% static '/images/amongus.png' %}"
                },
                {
                    "id": 3,
                    "name": "Old Fashioned",
                    "price": 13,
                    "image": "{% static '/images/amongus.png' %}"
                },

            ];
                // .then(response => response.json())
                // .then(data => {
                //     listProducts = data;
            addDataToHTML();

            // get cart from memory
            if(localStorage.getItem('cart')){
                carts = JSON.parse(localStorage.getItem('cart'));
                addCartToHTML();
            }
        }
        initApp();

    </script>

</body>
</html>